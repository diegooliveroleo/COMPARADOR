# ğŸ“„ Comparador de Documentos Word

Este proyecto permite **comparar varios documentos Word (.docx)** para detectar similitudes entre ellos.  
Se utiliza tanto la coincidencia literal como mÃ©todos estadÃ­sticos, probabilÃ­sticos y semÃ¡nticos, lo que lo convierte en una herramienta Ãºtil para:

- ğŸ” **DetecciÃ³n de plagio o parÃ¡frasis**  
- ğŸ“‘ **Control de versiones de informes**  
- ğŸ§ª **InvestigaciÃ³n acadÃ©mica y empresarial**  
- ğŸ›¡ **AuditorÃ­a de documentaciÃ³n en consultorÃ­a**  

Incluye una **interfaz grÃ¡fica (GUI)** para facilitar la selecciÃ³n de carpetas y la ejecuciÃ³n del anÃ¡lisis, asÃ­ como un **script CLI** para ejecuciÃ³n directa en terminal.

---

## âš™ï¸ Algoritmos implementados

El comparador aplica **cinco enfoques distintos**:

1. **Literal â€“ Distancia de Levenshtein (RapidFuzz)**  
   - Compara cadenas carÃ¡cter por carÃ¡cter.  
   - Ãštil para detectar **copias exactas** o mÃ­nimas ediciones.

2. **Conjuntos â€“ Jaccard**  
   - Compara conjuntos de palabras compartidas entre documentos.  
   - Detecta si dos textos usan un **vocabulario similar**.

3. **Vectorial â€“ TF-IDF + Coseno (Scikit-Learn)**  
   - Representa los documentos como vectores segÃºn la frecuencia de las palabras.  
   - Permite medir similitudes **estadÃ­sticas** incluso con redacciÃ³n diferente.  

4. **ProbabilÃ­stico â€“ LDA (Latent Dirichlet Allocation)**  
   - Descubre **temas ocultos** en los documentos.  
   - Cada documento se representa como una mezcla de temas.  
   - Ãštil para comparar documentos a nivel **conceptual**, aunque no compartan palabras.  
   âš  Nota: es **no determinista**, los resultados pueden variar si no se fija `random_state`.

5. **SemÃ¡ntico â€“ SBERT (Sentence-BERT)**  
   - Convierte los documentos en **embeddings** (vectores de significado) mediante modelos de deep learning.  
   - Detecta **parÃ¡frasis y similitud semÃ¡ntica** aunque las frases estÃ©n redactadas de forma distinta.  
   - Modelos incluidos:  
     - `paraphrase-MiniLM-L6-v2` (rÃ¡pido, por defecto)  
     - `all-MiniLM-L12-v2`  
     - `all-mpnet-base-v2` (mÃ¡s preciso, mÃ¡s pesado)

---

## ğŸ–¥ï¸ Interfaz grÃ¡fica (GUI)

La GUI permite:  
- Seleccionar la carpeta de documentos `.docx`.  
- Incluir/excluir subcarpetas.  
- Elegir el nombre del Excel de salida.  
- Seleccionar el modelo SBERT.  
- Definir nÃºmero de temas LDA (`auto` o manual).  
- Ajustar cuÃ¡ntos pares mostrar en los rankings.  
- Ver en la propia ventana los mensajes del proceso en tiempo real.  
- Exportar resultados a Excel.

Cada control tiene **tooltip de ayuda** al pasar el ratÃ³n.

---

## ğŸ“Š Resultados

El programa genera un **archivo Excel** con:  
- Matriz de similitud de cada mÃ©todo (`1_Literal`, `2_Conjuntos`, `3_Vectorial`, `4_Probabilistico`, `5_Semantico`).  
- Hojas con los **TOP K pares de documentos mÃ¡s similares** por mÃ©todo (`TOP_*`).  

Los valores de similitud se expresan en **porcentaje (0â€“100%)**.

---

## ğŸš€ InstalaciÃ³n

1. Clonar el repositorio o copiar los scripts.  
2. Crear un entorno virtual (opcional pero recomendado):  
   ```bash
   python -m venv .venv
   source .venv/bin/activate   # Linux/Mac
   .venv\Scripts\activate      # Windows
   ```
3. Instalar dependencias:  
   ```bash
   pip install -r requirements.txt
   ```

### Dependencias principales
- `python-docx` â†’ lectura de Word  
- `unidecode`, `nltk` â†’ normalizaciÃ³n de texto  
- `rapidfuzz` â†’ distancia de Levenshtein  
- `scikit-learn` â†’ TF-IDF, LDA  
- `pandas`, `openpyxl` â†’ exportar resultados a Excel  
- `sentence-transformers` â†’ embeddings SBERT  
- `gensim` â†’ soporte extra para modelos de tÃ³picos  

---

## ğŸƒ Uso por consola

Ejecutar el comparador directamente:

```bash
python comparadorv2.py "C:\ruta\a\carpeta\docs" --recursivo --salida resultados.xlsx --modelo paraphrase-MiniLM-L6-v2 --lda_topics auto --topk 50
```

ParÃ¡metros:  
- `--recursivo` â†’ incluir subcarpetas  
- `--salida` â†’ nombre del Excel  
- `--modelo` â†’ modelo SBERT (`MiniLM`, `mpnet`, etc.)  
- `--lda_topics` â†’ nÂº de temas (`auto` o entero)  
- `--topk` â†’ nÂº de pares mÃ¡s similares por ranking  

---

## ğŸ–¥ï¸ Uso con interfaz grÃ¡fica

```bash
python gui_comparador.py
```

Desde la GUI puedes configurar todas las opciones y ejecutar el anÃ¡lisis con un clic.

---

## ğŸ“¦ Generar ejecutable

Se recomienda usar **PyInstaller** para distribuir la aplicaciÃ³n sin necesidad de instalar Python:

1. Empaquetar el motor CLI:  
   ```powershell
   pyinstaller --console --name comparador_cli --collect-all sentence_transformers comparadorv2.py
   ```
2. Empaquetar la GUI:  
   ```powershell
   pyinstaller --windowed --name ComparadorGUI --add-data "%APPDATA%\nltk_data;nltk_data" gui_comparador.py
   ```
3. Entregar ambos EXE en una misma carpeta.

---

## âš ï¸ Limitaciones conocidas
- El mÃ©todo LDA es **aproximado y no determinista** si no se fija semilla (`random_state`).  
- El modelo SBERT puede tardar la primera vez porque descarga embeddings desde HuggingFace.  
- Archivos `.docx` muy grandes pueden ralentizar el cÃ¡lculo.  

---

## ğŸ“š Referencias
- [Sentence-Transformers](https://www.sbert.net/)  
- [Scikit-Learn â€“ Text Feature Extraction](https://scikit-learn.org/stable/modules/feature_extraction.html)  
- [Gensim â€“ Topic Modeling with LDA](https://radimrehurek.com/gensim/models/ldamodel.html)  
- [NLTK Stopwords](https://www.nltk.org/)  
